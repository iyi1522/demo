<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>相册</title>
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/upper.css">
    <style>
      .container {
    width: 90%;
    margin: 0 auto;
    position: relative;
  }
  
  /* 图片样式 */
    .container img {
    position: absolute;
    transition: all 0.5s;      /* 秒数可以改 */
    width: 220px;
  }
    </style>
</head>
<body>
    <!-- 头部区域 -->
     <div class="dachangtiao">
      <div class="container">
        <div class="topbar">
          <div class="logo">
            <img src="images/head sculpture.png" alt="" />
          </div>
          <span class="welcome">欢迎光临</span>
          <div class="nav">
            <ul class="nav-daohang">
              <li><a href="index.html">首页</a></li>
              <li><a href="index.html">北海游玩</a></li>
              <li><a href="picture.html">相册</a></li>
              <li><a href="I want to say.html">我想说</a></li>
              <li><a href="future self.html">未来的自己</a></li>
            </ul>
          </div>
          <div class="user">
          <a href="login.html" class="login">登录</a>
          <a href="login.html" class="register">注册</a>
        </div>
      </div>
        </div>
      </div>
    </div>
    <!-- 瀑布流图片 -->
    <div id="container" class="container">
    </div>
    <!-- 返回顶部 -->
    <div id="scrollToTop" onclick="scrollToTop()">
    <img src="images/guding.png" alt="">
  </div>

    <!-- 页脚 -->
    <div class="footer">
      <p>欢迎下次光临</p>
    </div>
    <script src="javascript/guding.js"></script>
    <script>
      
    var div = document.querySelector("#container") //获取dom元素
var imgWidth = 220

function creatImg() {
    //创建img元素   这里的  i = 1 表示images文件夹中图片命名从 1 开始 ，images文件夹中的图片要改为 1.jpg ，2.jpg ， 3jpg ， ……   
    // i++表示从 1 开始，一直到加到100
    //i 等于的数字可以修改，如果修改，那就要从images文件夹里面的图片命名为修改后i 等于多少的数字    修改后的数字.jpg 
    // i <= 47 表示设置了47张图片  图片放多少张就写多少，如果写多了，底下就会出现你看到的那种效果
    //反正就是将images文件夹中的jpg图片命名从1.jpg开始，一直命名 i<= 多少的数字 .jpg 
    for (var i = 1; i <= 66; i++) {
        var src = `images/${i}.jpg`//循环拿到照片  jpg表示images文件夹中图片后缀名
        var img = document.createElement('img')//创建img元素
        img.src = src;//设置图片的src地址
        img.style.width = imgWidth; //设置图宽度
        //在div里面添加图片
        div.appendChild(img)
        //排列每一张图片
        img.onload = setPositions; //排列
    }
}
    //获取最大最小值
function getMin(arr) {
    var min = Math.min(...arr)
    return min
}
function getMax(arr) {
    var max = Math.max(...arr)
    return max
}
//排列！！！重点在这
function setPositions() {
    var containerWidth = div.clientWidth; //获取容器宽度
    var columns = Math.floor(containerWidth / imgWidth) //列数 容器宽度除照片的宽度，然后向下取整，得到最多装下多少列图片，剩下的部分作为间隙宽度
    var spaceNumber = columns + 1 //间隙数量=列数+1
    var leftSpac = containerWidth - columns * imgWidth //间隙总宽度等于容器宽度-（列数*照片宽度）
    var space = leftSpac / spaceNumber //每个间隙的空间=总宽度/间隙数
    //创建数组保留每一列的高度
    var arr = new Array(columns)
    arr.fill(0)//给数组填充0

    for (var i = 0; i < div.children.length; i++) {
        var img = div.children[i];  
        var min = getMin(arr)  //获取最小的那个一个
        img.style.top = min + "px";  //开始排列，每张图片都排列到高度最小的那个一列，就是要改变当前列的高度
        var index = arr.indexOf(min)           // 首先找到这个最小数对应的列数
        //新高度   新的高度 = 图片的高度 + 间隙的高度
        arr[index] += img.height + space;
        //整个top完成，还需要确定间隙的值
        //间隙值和列数有关，index+1保证设置的是距离左边的值以index为0解释
        //第一列*平均间隙宽度+0（第一列在数组种为0）*照片宽度
        //以第二列为例 2*平均宽度+1*照片宽度 第二列的位置在第一列距离左边的间隙+照片长度+第二列距离第一列的间隙
        var left = (index + 1) * space + index * imgWidth;
        img.style.left = left + "px";
    }
// 因为图片是绝对定位，脱离了标准流，所以无法撑开盒子的高度，所以利用最高的一列撑开盒子
    var max=getMax(arr)
    div.style.height=max+"px";
}
//函数防抖
var timeId=null;//计时器id
function change(){
    window.onresize=function(){
        //该函数会在窗口大小改变时重新对图片进行排列
    //至此简单的瀑布流已经完成接下来进行防抖
        if(timeId){//如果计时器存在则清除掉重新记录新的
            clearTimeout(timeId)
        }
        timeId=setTimeout(setPositions,50)
    }
}
function main() {
    //加入图片初始化操作
    creatImg()
    //绑定事件
    change()
}
main();
    </script>
    
</body>

</html>